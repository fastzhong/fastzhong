```sq1
SELECT DISTINCT transaction_id, account_number, account_currency, initiation_time, customer_transaction_status, bank_reference_id, resource_id, feature_id, company_id, company_group_id, CHANGE_TOKEN, transaction_currency, TOTAL_AMOUNT, RECIPIENTS_REFERENCE, VALUE_DATE, original_uetr, is_recurring, destination_country, destination_bank_name, fx_flag, party_name, party_account_number, party_account_currency, bank_code, swift_code, beneficiary_reference_id, party_type, residency_status, party_id, proxy_id_type, id_issuing_country, address_line_1, address_line_2, address_line_3, phone_country, phone_country_code, phone_no, fx_type, booking_ref_id, earmark_id, TOTAL_CHILD, HIGHEST_AMOUNT, upload_file_name, correlation_Id, batch_id 
FROM ( 
	
	SELECT txn.transaction_id, txn.account_number, txn.account_currency, txn.initiation_time, txn.customer_transaction_status, txn.bank_reference_id, txn.resource_id, txn.feature_id, txn.company_id, txn.company_group_id, txn.CHANGE_TOKEN, txni.transaction_currency, txni.transaction_amount AS TOTAL_AMOUNT, txni.customer_reference AS RECIPIENTS_REFERENCE, txni.value_date as VALUE_DATE, txni.original_uetr, txni.is_recurring, txni.destination_country, txni.destination_bank_name, txni.fx_flag, pty.party_name, pty.party_account_number, pty.party_account_currency, pty.bank_code, pty.swift_code, pty.beneficiary_reference_id, pty.party_type, pty.residency_status, pty.party_id, pty.proxy_id_type, pty.id_issuing_country, ptyc.address_line_1, ptyc.address_line_2, ptyc.address_line_3, ptyc.phone_country, ptyc.phone_country_code, ptyc.phone_no, ptfc.fx_type, ptfb.booking_ref_id, ptfb.earmark_id, txn.TOTAL_CHILD, txn.HIGHEST_AMOUNT, null AS UPLOAD_FILE_NAME, null as correlation_Id, txn.batch_id 
	FROM PWS_TRANSACTIONS txn 
	INNER JOIN PWS_TRANSACTION_INSTRUCTIONS txni on txn.transaction_id = txni.transaction_id 
	LEFT JOIN PWS_PARTIES pty on pty.transaction_id = txni.transaction_id 
	LEFT JOIN PWS_PARTY_CONTACTS ptyc on pty.party_id = ptyc.party_id AND ptyc.PARTY_CONTACT_TYPE = ? 
	LEFT JOIN PWS_TRANSACTION_FX_CONTRACTS ptfc on ptfc.transaction_id = txni.transaction_id AND ptfc.bank_reference_id = txn.bank_reference_id 
	LEFT JOIN PWS_TRANSACTION_FX_BOOKINGS ptfb on ptfb.booking_id = ptfc.booking_id 
	WHERE 
	txn.company_group_id in 421 
	AND txn.COMPANY_ID in ( ? , ? , ? , ? , ? ) 
	AND ( ( txn.account_number) IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ) 
	
	AND ( (txn.company_group_id || '_' || txn.COMPANY_ID || '_' || txn.account_number || '_' || txn.RESOURCE_ID || '_' || txn.FEATURE_ID) IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ) 
	
	AND trunc(txn.initiation_time) between '18-Nov-2024' and '16-Jan-2025' 
	AND txn.customer_transaction_status NOT IN ( 'PENDING_SUBMIT', 'NEW', 'DELETED' ) 
	AND nvl(txn.application_type,'X') != 'terminateRecurring' 
	
	UNION ALL 
	
	SELECT txn.transaction_id, txn.account_number, txn.account_currency, txn.initiation_time, txn.customer_transaction_status, txn.bank_reference_id, txn.resource_id, txn.feature_id, txn.company_id, txn.company_group_id, txn.CHANGE_TOKEN, txn.TRANSACTION_CURRENCY, txn.TOTAL_AMOUNT, btxn.RECIPIENTS_REFERENCE, btxn.TRANSFER_DATE as VALUE_DATE, btxni.original_uetr as original_uetr, null as is_recurring, null as destination_country, null as destination_bank_name, null as fx_flag, null as party_name, null as party_account_number, null as party_account_currency, null as bank_code, null as swift_code, null as beneficiary_reference_id, null as party_type, null as residency_status, null as party_id, null as proxy_id_type, null as id_issuing_country, null as address_line_1, null as address_line_2, null as address_line_3, null as phone_country, null as phone_country_code, null as phone_no, null as fx_type, null as booking_ref_id, null as earmark_id, txn.TOTAL_CHILD, txn.HIGHEST_AMOUNT, pfu.upload_file_name AS UPLOAD_FILE_NAME, null as correlation_Id, txn.batch_id 
	FROM PWS_TRANSACTIONS txn 
	LEFT JOIN PWS_BULK_TRANSACTIONS btxn on btxn.transaction_id = txn.transaction_id 
	LEFT JOIN PWS_BULK_TRANSACTION_INSTRUCTIONS btxni on txn.transaction_id = btxni.transaction_id 
	LEFT JOIN pws_file_upload pfu on pfu.FILE_UPLOAD_ID = btxn.FILE_UPLOAD_ID 
	WHERE 
	txn.company_group_id in 421 
	AND txn.COMPANY_ID in ( ? , ? , ? , ? , ? ) 
	AND txn.account_number in ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) 
	
	AND ( (txn.company_group_id || '_' || txn.COMPANY_ID || '_' || txn.account_number || '_' || txn.RESOURCE_ID || '_' || txn.FEATURE_ID) IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) OR (txn.company_group_id || '_' || txn.COMPANY_ID || '_' || txn.account_number || '_' || txn.RESOURCE_ID || '_' || txn.FEATURE_ID) IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ) 
	
	AND trunc(txn.initiation_time) between '18-Nov-2024' and '16-Jan-2025' 
	AND txn.customer_transaction_status NOT IN ( 'PENDING_SUBMIT', 'NEW', 'DELETED' ) 
	AND nvl(txn.application_type,'X') != 'terminateRecurring' 
	
	Union All 
	
	SELECT txn.transaction_id, txn.account_number, txn.account_currency, txn.initiation_time, rtxn.status AS customer_transaction_status, txn.bank_reference_id, txn.resource_id, txn.feature_id, txn.company_id, txn.company_group_id, rtxn.change_token AS CHANGE_TOKEN, txni.transaction_currency, txni.transaction_amount AS TOTAL_AMOUNT, txni.customer_reference AS RECIPIENTS_REFERENCE, rtxn.processing_date AS value_date, rtxn.original_uetr as original_uetr, txni.is_recurring, txni.destination_country, txni.destination_bank_name, txni.fx_flag, pty.party_name, pty.party_account_number, pty.party_account_currency, pty.bank_code, pty.swift_code, pty.beneficiary_reference_id, pty.party_type, pty.residency_status, pty.party_id, pty.proxy_id_type, pty.id_issuing_country, ptyc.address_line_1, ptyc.address_line_2, ptyc.address_line_3, ptyc. phone_country, ptyc.phone_country_code, ptyc.phone_no, ptfc.fx_type, ptfb.booking_ref_id, ptfb. earmark_id, txn.TOTAL_CHILD, txn.HIGHEST_AMOUNT, null as UPLOAD_FILE_NAME, rtxn.correlation_id AS correlation_Id, txn.batch_id 
	from pws_transaction_instructions txni 
	JOIN pws_recurring_transactions rtxn ON txni.transaction_id = rtxn.transaction_id 
	Join pws_transactions txn on txn.transaction_id = rtxn.transaction_id 
	LEFT JOIN PWS_PARTIES pty on pty.transaction_id = txni.transaction_id 
	LEFT JOIN PWS_PARTY_CONTACTS ptyc on pty.party_id = ptyc.party_id AND ptyc.PARTY_CONTACT_TYPE = ? 
	LEFT JOIN PWS_TRANSACTION_FX_CONTRACTS ptfc on ptfc.transaction_id = txni.transaction_id AND ptfc.bank_reference_id = txn.bank_reference_id 
	LEFT JOIN PWS_TRANSACTION_FX_BOOKINGS ptfb on ptfb.booking_id = ptfc.booking_id 
	WHERE txni.is_recurring = 'Y' AND txn.customer_transaction_status IN ('PROCESSING', 'SUCCESSFUL', 'REJECTED', 'TERMINATED') ) bothTrans 
	
	ORDER BY bothTrans.initiation_time DESC OFFSET 0 ROWS FETCH NEXT 10 ROWS ONLY
```

```sql
SELECT COUNT(*) AS count FROM ( 
	
	SELECT DISTINCT txn.transaction_id FROM PWS_TRANSACTIONS txn 
	INNER JOIN PWS_TRANSACTION_INSTRUCTIONS txni on txn.transaction_id = txni.transaction_id 
	LEFT JOIN PWS_PARTIES pty on pty.transaction_id = txni.transaction_id 
	WHERE 
	txn.COMPANY_ID in ( ? , ? , ? , ? , ? ) 
	AND txn.company_group_id in 421 
	AND ( ( txn.account_number) IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ) 
	
	AND txn.COMPANY_ID in ( ? , ? , ? , ? , ? ) 
	AND txn.company_group_id in 421 
	AND txn.account_number in ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) 
	
	AND ( (txn.company_group_id || '_' || txn.COMPANY_ID || '_' || txn.account_number || '_' || txn.RESOURCE_ID || '_' || txn.FEATURE_ID) IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ) 
	
	AND trunc(txn.initiation_time) between '18-Nov-2024' and '16-Jan-2025' 
	
	AND txn.FEATURE_ID in 'Single-Transaction' AND txn.customer_transaction_status NOT IN ('PENDING_SUBMIT','NEW','DELETED') AND nvl(txn.application_type,'X') != 'terminateRecurring' 
	
	UNION ALL 
	
	SELECT DISTINCT txn.transaction_id FROM PWS_TRANSACTIONS txn 
	LEFT JOIN PWS_BULK_TRANSACTIONS btxn on btxn.transaction_id = txn.transaction_id 
	LEFT JOIN pws_file_upload pfu on pfu.FILE_UPLOAD_ID = btxn.FILE_UPLOAD_ID AND nvl(txn.application_type,'X') != 'terminateRecurring' 
	WHERE 
	txn.company_group_id in 421 
	AND txn.COMPANY_ID in ( ? , ? , ? , ? , ? ) 
	AND txn.account_number in ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) 
	
	AND ( (txn.company_group_id || '_' || txn.COMPANY_ID || '_' || txn.account_number || '_' || txn.RESOURCE_ID || '_' || txn.FEATURE_ID) IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) OR (txn.company_group_id || '_' || txn.COMPANY_ID || '_' || txn.account_number || '_' || txn.RESOURCE_ID || '_' || txn.FEATURE_ID) IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ) 
	
	AND trunc(txn.initiation_time) between '18-Nov-2024' and '16-Jan-2025' 
	AND txn.customer_transaction_status NOT IN ('PENDING_SUBMIT', 'NEW','DELETED' ) ) bothTrans
```

```java
@Slf4j
@Service
@RequiredArgsConstructor
public class TransactionWorkflowService {
    private final TransactionWorkflowDAO transactionWorkflowDAO;
    
    private final ExecutorService executorService = Executors.newFixedThreadPool(4);
    
    // Constants
    private static final String YES = "Y";
    private static final String DOT_SEPARATOR = ".";
    private static final String BOTH_TRANS = "bothTrans";
    private static final String LOWER = "lower";
    private static final String OPEN_BRACE = "(";
    private static final String SINGLE_TRANSACTION = "Single-Transaction";
    private static final int QUERY_TIMEOUT_SECONDS = 7;

    @Value("${transaction.concurrent.enabled:true}")
    private boolean concurrentExecutionEnabled;

    /**
     * Processes both approval status transactions
     */
    protected List<ApprovalStatusTxn> getBothApprovalStatus(FilterParams filterParams) {
        if (!shouldProcessBothApprovalStatus(filterParams)) {
            return new ArrayList<>();
        }

        processSortField(filterParams);
        setTransactionTypes(filterParams);

        try {
            // Execute main transaction list query
            CompletableFuture<List<ApprovalStatusTxn>> txnListFuture = executeAsync(
                () -> transactionWorkflowDAO.getBulkBothApprovalStatusTxnList(filterParams)
            );

            List<ApprovalStatusTxn> approvalStatusList = txnListFuture.get(QUERY_TIMEOUT_SECONDS, TimeUnit.SECONDS);
            
            if (ObjectUtils.isEmpty(approvalStatusList)) {
                return approvalStatusList;
            }

            List<String> transIds = extractTransactionIds(approvalStatusList);

            // Execute count and FX contracts queries concurrently
            CompletableFuture<Integer> countFuture = executeAsync(
                () -> transactionWorkflowDAO.getBulkBothApprovalStatusTxnCount(filterParams)
            );

            CompletableFuture<Map<String, ApprovalStatusTxn>> fxContractsFuture = executeAsync(
                () -> fetchFxContracts(transIds)
            );

            // Wait for both futures
            int count = countFuture.get(QUERY_TIMEOUT_SECONDS, TimeUnit.SECONDS);
            Map<String, ApprovalStatusTxn> fxContractMap = fxContractsFuture.get(QUERY_TIMEOUT_SECONDS, TimeUnit.SECONDS);

            updateApprovalStatusList(approvalStatusList, count, fxContractMap);

            return approvalStatusList;

        } catch (Exception e) {
            log.error("Error processing both approval status transactions", e);
            throw new TransactionProcessingException("Failed to process both approval status transactions", e);
        }
    }

    /**
     * Processes bulk approval status transactions
     */
    protected List<ApprovalStatusTxn> getBulkApprovalStatus(FilterParams filterParams) {
        if (!shouldProcessBulkApproval(filterParams)) {
            return new ArrayList<>();
        }

        return YES.equalsIgnoreCase(filterParams.getIsChild()) 
            ? processChildTransactions(filterParams)
            : processParentTransactions(filterParams);
    }

    // Private helper methods for getBothApprovalStatus
    private boolean shouldProcessBothApprovalStatus(FilterParams filterParams) {
        return YES.equalsIgnoreCase(filterParams.getIsChannelAdmin())
            || ObjectUtils.isNotEmpty(filterParams.getSingleAccountBasedOnResourceFeatureList())
            || ObjectUtils.isNotEmpty(filterParams.getBulkAccountBasedOnResourceFeatureList());
    }

    private void processSortField(FilterParams filterParams) {
        String orderByWithDirection = filterParams.getSortFieldWithDirection();
        String orderBy = orderByWithDirection.substring(orderByWithDirection.indexOf(DOT_SEPARATOR) + 1);
        
        StringBuilder sortBuilder = new StringBuilder();
        if (orderByWithDirection.contains(LOWER)) {
            sortBuilder.append(LOWER).append(OPEN_BRACE);
        }
        sortBuilder.append(BOTH_TRANS).append(DOT_SEPARATOR).append(orderBy.trim());
        
        filterParams.setSortFieldWithDirection(sortBuilder.toString());
    }

    private void setTransactionTypes(FilterParams filterParams) {
        if (ObjectUtils.isNotEmpty(filterParams.getSingleAccountBasedOnResourceFeatureList())) {
            filterParams.setIsSingleTransaction(YES);
            filterParams.setSingleFeatureId(SINGLE_TRANSACTION);
        }
        if (ObjectUtils.isNotEmpty(filterParams.getBulkAccountBasedOnResourceFeatureList())) {
            filterParams.setIsBulkTransaction(YES);
        }
    }

    // Private helper methods for getBulkApprovalStatus
    private boolean shouldProcessBulkApproval(FilterParams filterParams) {
        return YES.equalsIgnoreCase(filterParams.getIsChannelAdmin())
            || CollectionUtils.isNotEmpty(filterParams.getBulkAccountBasedOnResourceFeatureList());
    }

    private List<ApprovalStatusTxn> processChildTransactions(FilterParams filterParams) {
        filterParams.setIsChildY(YES);
        
        try {
            CompletableFuture<List<ApprovalStatusTxn>> txnListFuture = executeAsync(
                () -> transactionWorkflowDAO.getBulkApprovalStatusTxnList(filterParams)
            );

            List<ApprovalStatusTxn> approvalStatusList = txnListFuture.get(QUERY_TIMEOUT_SECONDS, TimeUnit.SECONDS);
            
            if (ObjectUtils.isEmpty(approvalStatusList)) {
                return approvalStatusList;
            }

            int count = executeAsync(
                () -> transactionWorkflowDAO.getBulkApprovalStatusTxnCount(filterParams)
            ).get(QUERY_TIMEOUT_SECONDS, TimeUnit.SECONDS);

            log.info("Total number of transaction Count for Bulk Transaction {}", count);
            approvalStatusList.stream()
                .findFirst()
                .ifPresent(txn -> txn.setCount(BigDecimal.valueOf(count)));

            return approvalStatusList;

        } catch (Exception e) {
            log.error("Error processing child transactions", e);
            throw new TransactionProcessingException("Failed to process child transactions", e);
        }
    }

    private List<ApprovalStatusTxn> processParentTransactions(FilterParams filterParams) {
        filterParams.setIsChildN(YES);
        
        try {
            CompletableFuture<List<ApprovalStatusTxn>> txnListFuture = executeAsync(
                () -> transactionWorkflowDAO.getBulkParentApprovalStatusTxnList(filterParams)
            );

            List<ApprovalStatusTxn> approvalStatusList = txnListFuture.get(QUERY_TIMEOUT_SECONDS, TimeUnit.SECONDS);
            
            if (ObjectUtils.isEmpty(approvalStatusList)) {
                return approvalStatusList;
            }

            List<String> transIds = extractTransactionIds(approvalStatusList);

            // Execute all queries concurrently
            CompletableFuture<Integer> countFuture = executeAsync(
                () -> transactionWorkflowDAO.getBulkParentApprovalStatusTxnCount(filterParams)
            );

            CompletableFuture<Map<String, List<PwsTransactionCharges>>> chargesFuture = executeAsync(
                () -> fetchChargesDetail(transIds)
            );

            CompletableFuture<Map<String, ApprovalStatusTxn>> fxContractsFuture = executeAsync(
                () -> fetchFxContracts(transIds)
            );

            // Wait for all futures
            int count = countFuture.get(QUERY_TIMEOUT_SECONDS, TimeUnit.SECONDS);
            Map<String, List<PwsTransactionCharges>> chargesMap = chargesFuture.get(QUERY_TIMEOUT_SECONDS, TimeUnit.SECONDS);
            Map<String, ApprovalStatusTxn> fxContractMap = fxContractsFuture.get(QUERY_TIMEOUT_SECONDS, TimeUnit.SECONDS);

            updateParentTransactions(approvalStatusList, count, chargesMap, fxContractMap);

            return approvalStatusList;

        } catch (Exception e) {
            log.error("Error processing parent transactions", e);
            throw new TransactionProcessingException("Failed to process parent transactions", e);
        }
    }

    // Shared utility methods
    private <T> CompletableFuture<T> executeAsync(Supplier<T> supplier) {
        return concurrentExecutionEnabled
            ? CompletableFuture.supplyAsync(supplier, executorService)
            : CompletableFuture.completedFuture(supplier.get());
    }

    private List<String> extractTransactionIds(List<ApprovalStatusTxn> transactions) {
        return transactions.stream()
            .map(ApprovalStatusTxn::getTransactionId)
            .toList();
    }

    private Map<String, List<PwsTransactionCharges>> fetchChargesDetail(List<String> transIds) {
        return transactionWorkflowDAO.getChargesDetail(transIds).stream()
            .collect(Collectors.groupingBy(
                charge -> charge.getTransactionId().toString(),
                Collectors.mapping(
                    charge -> charge,
                    Collectors.toList()
                )
            ));
    }

    private Map<String, ApprovalStatusTxn> fetchFxContracts(List<String> transIds) {
        return transactionWorkflowDAO.getFxContracts(transIds)
            .stream()
            .collect(Collectors.toMap(
                ApprovalStatusTxn::getTransactionId,
                Function.identity(),
                (existing, replacement) -> existing
            ));
    }

    private void updateApprovalStatusList(
            List<ApprovalStatusTxn> approvalStatusList,
            int count,
            Map<String, ApprovalStatusTxn> fxContractMap) {
        
        BigDecimal countValue = BigDecimal.valueOf(count);
        approvalStatusList.forEach(approve -> {
            approve.setCount(countValue);
            ApprovalStatusTxn fx = fxContractMap.get(approve.getTransactionId());
            if (fx != null) {
                approve.setFxType(fx.getFxType());
                approve.setFxFlag(fx.getFxFlag());
                approve.setBookingRefId(fx.getBookingRefId());
                approve.setEarmarkId(fx.getEarmarkId());
            }
        });
    }

    private void updateParentTransactions(
            List<ApprovalStatusTxn> approvalStatusList,
            int count,
            Map<String, List<PwsTransactionCharges>> chargesMap,
            Map<String, ApprovalStatusTxn> fxContractMap) {

        chargesMap.forEach((transId, charges) -> {
            BigDecimal totalAmount = charges.stream()
                .map(PwsTransactionCharges::getFeesAmount)
                .reduce(BigDecimal.ZERO, BigDecimal::add);

            String transCurrency = charges.stream()
                .findFirst()
                .map(PwsTransactionCharges::getFeesCurrency)
                .orElse(null);

            ApprovalStatusTxn fx = fxContractMap.get(transId);

            approvalStatusList.stream()
                .filter(approve -> approve.getTransactionId().equalsIgnoreCase(transId))
                .forEach(approv -> {
                    approv.setFeesCurrency(transCurrency);
                    approv.setTotalFeeAmount(totalAmount);
                    if (fx != null) {
                        approv.setFxType(fx.getFxType());
                        approv.setFxFlag(fx.getFxFlag());
                        approv.setBookingRefId(fx.getBookingRefId());
                        approv.setEarmarkId(fx.getEarmarkId());
                    }
                });
        });

        approvalStatusList.stream()
            .findFirst()
            .ifPresent(txn -> txn.setCount(BigDecimal.valueOf(count)));
    }

    @PreDestroy
    public void cleanup() {
        executorService.shutdown();
        try {
            if (!executorService.awaitTermination(800, TimeUnit.MILLISECONDS)) {
                executorService.shutdownNow();
            }
        } catch (InterruptedException e) {
            executorService.shutdownNow();
            Thread.currentThread().interrupt();
        }
    }
}

@Slf4j
public class TransactionProcessingException extends RuntimeException {
    public TransactionProcessingException(String message, Throwable cause) {
        super(message, cause);
    }
}
```

```java
Map<String, String> payrollAccounts = new HashMap<>();
List<String> payrollConfigValues = new ArrayList<>();

// Assuming payrollAccounts and payrollConfigValues are already populated and of the same size

Map<String, String> updatedPayrollAccounts = IntStream.range(0, payrollAccounts.size())
    .boxed()
    .collect(Collectors.toMap(
        i -> payrollConfigValues.get(i),
        i -> payrollAccounts.get(payrollAccounts.keySet().toArray(new String[0])[i]),
        (v1, v2) -> v1,
        LinkedHashMap::new
    ));

payrollAccounts = updatedPayrollAccounts;
```

